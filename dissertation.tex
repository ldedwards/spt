\documentclass[british]{amsart}
\usepackage{lmodern}

% Bibliography
\usepackage[backend=biber,style=alphabetic]{biblatex}
\addbibresource{spt.bib}

\renewcommand{\sfdefault}{lmss}
\renewcommand{\ttdefault}{lmtt}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{verbatim}
\usepackage{amstext}
\usepackage{amsthm}
\usepackage{amssymb}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\numberwithin{equation}{section}
\numberwithin{figure}{section}
\theoremstyle{plain}
\newtheorem{thm}{\protect\theoremname}[section]
\theoremstyle{definition}
\newtheorem{defn}[thm]{\protect\definitionname}
\theoremstyle{plain}
\newtheorem{assumption}[thm]{\protect\assumptionname}
\theoremstyle{plain}
\newtheorem{lem}[thm]{\protect\lemmaname}
\theoremstyle{plain}
\newtheorem{prop}[thm]{\protect\propositionname}
\theoremstyle{remark}
\newtheorem{rem}[thm]{\protect\remarkname}
\theoremstyle{plain}
\newtheorem{cor}[thm]{\protect\corollaryname}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{color}
\usepackage[colorlinks=true,linkcolor={blue}]{hyperref}

\usepackage{amsfonts}
%\renewenvironment{lyxgreyedout}{\color{red}\bgroup}{\egroup}

\makeatother

\usepackage[british]{babel}
\usepackage[babel]{csquotes}
\addto\captionsbritish{\renewcommand{\assumptionname}{Assumption}}
\addto\captionsbritish{\renewcommand{\definitionname}{Definition}}
\addto\captionsbritish{\renewcommand{\lemmaname}{Lemma}}
\addto\captionsbritish{\renewcommand{\propositionname}{Proposition}}
\addto\captionsbritish{\renewcommand{\remarkname}{Remark}}
\addto\captionsbritish{\renewcommand{\theoremname}{Theorem}}
\addto\captionsenglish{\renewcommand{\assumptionname}{Assumption}}
\addto\captionsenglish{\renewcommand{\definitionname}{Definition}}
\addto\captionsenglish{\renewcommand{\lemmaname}{Lemma}}
\addto\captionsenglish{\renewcommand{\propositionname}{Proposition}}
\addto\captionsenglish{\renewcommand{\remarkname}{Remark}}
\addto\captionsenglish{\renewcommand{\theoremname}{Theorem}}
\addto\captionsenglish{\renewcommand{\corollaryname}{Corollary}}
\providecommand{\assumptionname}{Assumption}
\providecommand{\definitionname}{Definition}
\providecommand{\lemmaname}{Lemma}
\providecommand{\propositionname}{Proposition}
\providecommand{\remarkname}{Remark}
\providecommand{\theoremname}{Theorem}
\providecommand{\corollaryname}{Corollary}

%%%%%%%%%%%%%%%%%%%
\renewcommand{\d}[1]{\mathop{\mathrm{d}{#1}}}
\newcommand{\msquared}{\mathcal{M}^{2}_{0,T}}
\newcommand{\realnumbers}{\mathbb{R}}
\newcommand{\ranget}{t\in[0,\infty)}
\newcommand{\filtration}[1]{\mathcal{F_{#1}}}
\newcommand{\defeq}{\mathop{\triangleq}}
\newcommand{\almostsurely}{\text{a.s.}}
\newcommand{\E}[1]{\mathbb{#1}}
%%%%%%%%%%%%%%%%%%%

\begin{document}
\title{Functionally Generated Portfolios in Stochastic Portfolio Theory}
\author{Lawrence Edwards}
\maketitle

\tableofcontents{}

\section{Introduction}
% Stochastic Portfolio Theory (\textbf{SPT}) was first introduced by Fernholz and 
% Shay (1982) \cite{fernholz1982}, formalised in Fernholz (1999) 
% \cite{fernholz1999} and was further developed by Fernholz (2002) 
% \cite{fernholz2002}. It has evolved into a flexible framework for analysing 
% portfolio behaviour and equity market structure that has both theoretical and 
% practical applications.
% 
% From a theoretical standpoint, the framework provides insight into questions 
% regarding the behaviour of the market as well as arbitrage, and can be used to 
% construct portfolios with controlled behaviour under quite general assumptions. 
% 
% The framework does not assume the existence of equivalent local martingale
% measures (equivalent to the assumption of \textbf{No Free Lunch with Vanishing 
% Risk} (NFLVR)), detailed by Delbaen and Schachermayer \cite{delbaen1994}. In 
% fact, most models developed in the framework satisfy only the weaker \textbf{No 
% Unbounded Profit with Bounded Risk assumption} (NUPBR), which holds if and only 
% if a local martingale deflator exists, which was shown by Kardaras 
% \cite{kardaras2012}. 
% 
% NUPBR plays the role of Radon-Nikodym derivative in the case that an equivalent
% local martingale measure does exist.  Karatzas and Kardaras (2007) proved that 
% NUPBR is a necessary and sufficient condition for the log-utility maximization 
% problem to have a solution. For an overview of these different notions of 
% arbitrage, and their relation to the existence of deflators and equivalent 
% measures, we refer the reader to Fontana (2015).
% 
% As a practical tool, SPT has been applied to the analysis and optimization of 
% portfolio performance and has been the basis of successful equity investment 
% strategies for over a decade.
% 
% * importance of portfolio construction in finance
% * proportion of the market that is passively investing wealth in financial 
% market has been growing
% * a relatively recent approach to creating portfolios
% 
% A thorough survey in Fernholz and Karatzas \cite{fernholz2009} and recently
% by Vervuurt \cite{vervuurt2015}.
% 
% * relatively general market model is assumed
% * continuous-time model with weak no-arbitrage assumptions
% * portfolio selection criteria is to outperform a benchmark with probability 1
% * relies on a method of \textit{functional generation} to constructs portfolios
% that rely deterministically only on the market capitalisation (or equivalently 
% prices)
% 
% An example is the Diversity weighted ortfolios (DWP)
% * builds on the concept of diversification leading to superior returns
% * we present the in-depth theoretical basis showing that the DWP outperforms the 
% market index, including recent enhancements by \cite{vervuurt2016} that
% extend the basic formulation to include negative-weighted parameters.
% 
% Vervuurt \cite{vervuurt2015} notes in his survey that hardly any of the 
% theoretical results in SPT have been tested using real market data. We aim as 
% part of this dissertation to provide an in-depth empirical study of the European 
% equity market, examining the assumptions and the real world implementation of
% such strategies, including frictions such as:

\begin{description}
	\item [Corporate actions] including splits
	\item [Transaction costs] realistic trading costs based on an accurate 
		market impact model
	\item [Market imperfections] including indivisibility of shares, entries 
		and exits from the universe etc.
\end{description}

\section{Preliminaries}

% This section provides a concise overview of stochastic calculus for
% diffusion processes. The model for continuous stock prices presented
% here has an extensive literature can be found in \cite{shreve2012}.
% Throughout, we work on a \textbf{filtered probability space} denoted
% by $(\Omega,\filtration,\left\{ \filtration{t}\right\} ,P)$
% where:

\begin{itemize}
	\item $\Omega$ denotes the space of all events,
	\item $\mathcal{F}$ denotes the set of all measurable events,
	\item ${ \mathcal{F}_{t}} _{t\ge0}$ denotes the filtration
		- a family of $\sigma$-algebras contained in $\mathcal{F}$ with
		the property that if $s<t$ then $\mathcal{F}_{s}\subset\mathcal{F}_{t}$. 
\end{itemize}

\begin{defn} [Stochastic Processes]
	\label{def:stochasticprocesses}

	The modelling of random assets in finance is based on \textbf{stochastic
	processes}, which are families $X(t)$  of random variables $X(t):\Omega\to\mathbb{R}$
	for $t\in[0,T]$, where $X(0)$ is constant.

\end{defn}

\subsection{Diffusion Processes}

% We introduce the stochastic process known as a Brownian motion (also sometimes 
% referred to as a Weiner process).

\begin{defn} [Standard Brownian Motion]
	\label{def:brownianmotion}

	A Standard Brownian motion $W(\cdot)$ is a stochastic process 
	(Definition \ref{def:stockpriceprocess})  which is a 	mapping 
	$W:[0,\infty)\times\Omega\to\mathbb{R}$ for a probability	space 
	$(\Omega,\mathcal{F},P)$ which has the properties: 

	\begin{enumerate}
		\item $W(0)=0 \quad \almostsurely$,
		\item $W(t)$ has \textbf{independent increments,}
		\item $W(t)$ has \textbf{stationary increments} 
			$W(t)-W(s)\thicksim\mathcal{N}(0,t-s)$for $0\le s<t<\infty,$
		\item the sample trajectories for almost all $\omega\in\Omega$ the paths 
			$t\to W(t,\omega)$ are \textbf{almost surely continuous.}
	\end{enumerate}

\end{defn}

\begin{thm} [Martingale property of Brownian motion]
	\label{tmh:brownianmotionmartingaleproperty}

	(Definition \ref{def:brownianmotion})
	(Definition \ref{def:martingale})

	\begin{equation*}
		\E{W(t) \mid \filtration{s}} = W_{s}
	\end{equation*}

\end{thm}

\begin{defn} [Quadratic Variation]
	\label{def:quadraticvariation}

	For a stochastic process (Definition \ref{def:stochasticprocesses}) $X(\cdot)$ we write

	\begin{equation*}
		\left< X \right>_{t} \defeq i
			\lim_{\max{(t_{n+1}-t_{n}}\to0}
			\sum \left| \right|
	\end{equation*}

\end{defn}

\begin{thm} [Quadratic variation of Brownian motion]
	\label{thm:quadraticvariationofbrownianmotion}

	(\ref{def:quadraticvariation})
	(\ref{def:brownianmotion})

	\begin{equation}
		\left<W(t)\right>_{t} = t \quad \almostsurely.
	\end{equation}

\end{thm}

\subsection{It\^{o} Calculus}

\begin{defn} [It\^{o} Process]
	\label{def:itoprocess}
	TODO: write
\end{defn}

\begin{defn} [It\^{o} Formula]
	\label{def:itoformula}
	TODO: flesh out
\end{defn}

\begin{thm} [Quadratic variation of It\^{o} processes]
	\label{thm:quadraticvariationofitoprocess}

	For an It\^{o} process $X(\cdot)$ 
	
	\begin{equation*}
		\d{X(t)} = a(t)\d{t} + b(t)\d{W(t)}
	\end{equation*}
	
	then the quadratic variation of $X$ is
	
	\begin{equation*}
		\left< X \right>_{t} = \int_{0}^{t} b^2(s)\d{s}.
	\end{equation*}

\end{thm}

\begin{proof}
	We start with the result for continuous, \textit{square-integrable} martingale 
	$I(X) \in \msquared$ given in \cite{shreve2012} (Equation 2.19).

	\begin{equation*}
		\left<I(X)\right>_{t} = \int_{0}^{t} X_{M}^2 d\left<M\right>_{M}.
	\end{equation*}

	and note that since (TODO: compete)
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% SPT DEFINITIONS
\newcommand{\abs}[1]{\mathop{|{#1}|}}
\newcommand{\market}{\mathcal{M}}
\newcommand{\rangei}{i=1,\dots,n}
\newcommand{\measure}{\mathbb{P}}
\newcommand{\probabilityspace}{(\Omega,\filtration,\measure)}

\section{Stochastic Portfolio Theory}

\subsection{Market Model}

Assumptions:
\begin{itemize}
	\item number of companies is fixed and finite
	\item number of shares of each company is constant
	\item each company has a single share of stock outstanding
	\item no issues with indivisibility of shares (i.e. fractional share 
				quantities are allowed)
	\item no mergers or splits
	\item continuous trading
	\item no dividends
	\item no taxes
	\item no transaction costs
\end{itemize}

\begin{defn} [The Equity Market Model]
	\label{def:marketmodel}
 	\cite{fernholz2009} 
	We define market $\market$, with $n$ stocks, and $d$-dimensional independent Brownian 
	motion $W(\cdot)$ (with $d \ge n$), defined on a probability space 
	$\probabilityspace$ as

	\begin{equation*}
		\label{eq:equitymarketmodelriskfree}
		\d{B(t)} = B(t)r(t)\d{t},
		\quad \ranget
	\end{equation*}

	\begin{equation}
		\label{eq:stockpriceprocess}
		\d{X_{i}(t)} = X_{i}(t) 
				\left[
					b_{i}(t)dt + 
					\sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
				\right],
				\quad \rangei,
				\quad \ranget
	\end{equation}

	Where $W = \left\{ W(t)=(W_{1}(t),...,W_{n}(t)),\filtration{t},\ranget \right\}$.

	Where $B(0)=1$ and $r(\cdot)$ is the interest-rate process for the money-market.

	Stock price process $X_{i}(t)$ which represents the price of the $i$th stock, where 
	$X_{i}(0) = x_{i} > 0$ are the (strictly positive) initial values of the stock prices.

	We also assume the $\filtration{t}$-progressively measurable processes (Definition: 
	\ref{def:progressivelymeasureable)} $(n \times 1)$ process $b(\cdot)$ the 
	\textit{rates of return}, and $(n \times d)$ process $\sigma_{i\nu}(t)$ of the 
	\textit{volatilities} satisfy the integrability conditions (Definition: 
	\ref{def:itointegrabilityconditions})

	\begin{equation*}
		\int_{0}^{T} 
		\abs{r(t)} 
		\d{t} +
		\sum_{i=1}^{n} \int_{0}^{T} 
			\left( 
					\abs{b_{i}(t)} +
					\sum_{\nu=1}^{d} ( \sigma_{i\nu}(t)^2  ) 
					\right) \d{t} < \infty,
		\quad
		T \in [0, \infty),
		\almostsurely
	 \end{equation*}

\end{defn}

The Equation (\ref{eq:stockpriceprocess}) can also be written as 

\begin{equation}
	\label{eq:stockpriceprocessdiff}
		\frac{\d{X_{i}(t)}}{X_{i}(t)} = 
				b_{i}(t)dt + 
				\sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
			\quad \rangei,
			\quad \ranget
\end{equation}

and is often referred to as the "instantaneous" return on the stock.

\subsection{Stock Price Process}

\begin{prop} [Quadratic Variation of Logarithmic Stock Price Process]
	\label{prop:crossvarlogX}

	Let $X_{i}(\cdot)$ be a stock prices process defined as in (\ref{eq:stockpriceprocess}), 
	then the quadratic variation (Definition: \ref{def:quadraticvariation}) of
	$\log{X_{i}(\cdot)}$ satisfies

	\begin{equation}
		\d{\langle \log{X_{i}} \rangle_{t}} = \sum_{\nu=1}^{d} \sigma_{i\nu}^2\d{t},
		\quad \ranget,
		\quad \rangei,
		\quad \almostsurely
	\end{equation}

\end{prop}

\begin{proof} 

	From (Definition: \ref{def:quadraticvariation}), (Theorem: 
	\ref{thm:quadraticvariationofbrownianmotion}) and (Theorem: 
	\ref{thm:quadraticvariationofitoprocess}), for $\rangei$

	\begin{gather}
		\begin{split} 
			\label{eq:quadraticvariationlogX}
			\langle \log{X_{i}} \rangle_{t} 
			 & = \left< \int_{0}^{t} \sum_{\nu=1}^{d} \sigma_{i\nu}(s) \d{W_{\nu}(s)} \right>_{t} \\
			 & = \left< \sum_{\nu=1}^{d} \int_{0}^{t} \sigma_{i\nu}(s) \d{W_{\nu}(s)} \right>_{t} \\
			 & = \sum_{\nu=1}^{d} \left< \int_{0}^{t} \sigma_{i\nu}(s) \d{W_{\nu}(s)} \right>_{t} \\
			 & = \sum_{\nu=1}^{d} \int_{0}^{t} \sigma_{i\nu}^{2}(s) \d{\langle W_{\nu}(s) \rangle } \\
			 & = \int_{0}^{t} \sum_{\nu=1}^{d} \sigma_{i\nu}^{2}(s) \d{s}.
		\end{split}
	\end{gather}
	
	Then from (\ref{eq:quadraticvariationlogX}) we have
	
	\begin{gather}
		\begin{split}
			\d{\langle \log{X} \rangle_{t}}
				& = \d{\left<\int_{0}^{t} \sum_{\nu=1}^{d} \sigma_{\nu}(s) \d{W_{\nu}(s)}\right>_{t}}\\
				& = \d{\left(\int_{0}^{t} \sum_{\nu=1}^{d} \sigma_{\nu}^{2}(s) \d{s}\right)} \\
				& = \sum_{\nu=1}^{d} \sigma_{\nu}^{2}(t) \d{t}.
		\end{split}
	\end{gather}

\end{proof}

\begin{thm} [Logarithmic Representation of Stock Price Process]
	\label{thm:logarithmicrepresentation}

	Let $X_{i}(\cdot)$ be a stock prices process defined as in 
	(\ref{eq:stockpriceprocess}), then 

	\begin{equation} 
		\d{\log{X_{i}(t)}} = 
			\gamma_{i}(t)\d{t} + 
			\sum_{\nu=1}^{d} \sigma_{i\nu}(t){\d{W_{\nu}(t)}}, 
		\quad \rangei,
	\end{equation}

	or, equivalently in exponential form as

	\begin{equation*}
		X_{i}(t) = X_{i}(0) 
				\exp{ 
					\left(
						\int_{0}^{t} \gamma_{i}(s)\d{s} + \int_{0}^{t} 
						\sum_{\nu=1}^{d} \sigma_{i\nu}(s){\d{W_{\nu}(s)}} 
					\right)
				}, 
		\quad \ranget.
	\end{equation*}

	Where the (non-negative definite matrix-valued) \textit{covariance process} 
	$a_{i,j}(t)$ is defined as
	
	\begin{gather}
		\label{eq:covarianceprocess}
		\begin{split}
			a_{ij}(t)  
				& \defeq \sum_{\nu=1}^{d}\sigma_{i\nu}(t)\sigma_{j\nu}(t) \\ 
				& = \left( \sigma(t)\sigma'(t) \right)_{ij} \\
				& = \frac{d}{dt}\left\langle \log X_{i},\log X_{j}\right\rangle(t)
		\end{split}
	\end{gather}

	with ' denoting vector transposition, and the process $\gamma_{i}(t)$ called 
	the \textit{growth rate} is	defined as

	\begin{equation}
		\label{eq:gamma}
		\gamma_{i}(t)\defeq b_{i}(t)-\frac{1}{2}a_{ii}(t)
		\quad \rangei
	\end{equation}

\end{thm}

\begin{proof}
	We apply It\^{o}s formula (\ref{def:itoformula}) to the function $f(x)=\exp{x}$ with the argument $\log{X_{i}(t)}$, so for $\ranget$, $\rangei$

	\begin{gather*}
		\begin{split}
			\d{\log{X_{i}(t)}} 
			 	& = 
					\frac{\d{X_{i}(t)}}{X_{i}(t)} - 
						\frac{1}{2} \frac{d}{dt}\left\langle \log X_{i},\log X_{i}\right\rangle(t)
					\\
				& = 
					\left(
						b_{i}(t)\d{t} + 
						\sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
					\right)- 
					\frac{1}{2} \frac{d}{dt}\left\langle \log X_{i},\log X_{i}\right\rangle(t)
					\\
				& = 
					\left(
						b_{i}(t)\d{t} + 
						\sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
					\right)- 
					\frac{1}{2} \frac{d}{dt}\left\langle \log X_{i},\log X_{i}\right\rangle(t)
					\\
				& = 
					\left(
						b_{i}(t)\d{t} + 
						\sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
					\right)- 
					\frac{1}{2} a_{ii}(t)\d{t}
					\\
				& = 
					\left(
						b_{i}(t) -
						\frac{1}{2} a_{ii}(t)
					\right) \d{t} +
					\sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
					\\
				& = 
					\gamma_{i}(t) +
					\sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
				\quad \almostsurely
		\end{split}
	\end{gather*}

\end{proof}

\begin{thm} [Growth Rate of Stock Price Process]
	\label{thm:growthrate}

	The justification for the quantity (\ref{eq:gamma}) being called the 
	\textit{growth rate} is	because of the following relationship

	\begin{equation}
		\lim_{T \to \infty} 
			\left( 
			\log{X_{i}(T)} - \int_{0}^{T} \gamma_{i}(t)\d{t} 
			\right) = 0
		\quad \almostsurely
	\end{equation}

	TODO: Add the condition this is valid under.
	See also Equation 1.6 of \cite{fernholz2009}.

\end{thm}

\begin{proof}
	Build on Corollary 2.2 of \cite{fernholz1999}.
\end{proof}

\subsection{Strategies and Portfolios}

\begin{defn} [Trading Strategy]
	\label{def:tradingstrategy}

	A \textit{trading strategy} is a progressively measurable process $h(\cdot)$ 
	takes values in $\mathbb{R}^{n}$ with a wealth process $V^{w,h}(\cdot)$ 

 	\begin{equation*}
		V^{w,h}(t) = \sum_{i=1}^{n} h_{i}(t) X_{i}(t) 
		\quad \ranget
	\end{equation*}

	with $V^{w,h}(0)=w$ for $w > 0$. We also assume a trading strategy $h(\cdot)$  
	satisfies the integrability condition

 	\begin{equation*}
		\sum_{i=1}^{n} \int_{0}^{T} 
		\left(
		\abs{(h_{i}(t)b_{i}(t)} + h_{i}^2(t)a_{ii}(t)
			\right) \d{t} < \infty
		\quad	\almostsurely
	\end{equation*}

\end{defn}

\begin{defn} [Admissible Strategies]

	A trading strategy is called $x$-\textit{admissible} if for some $x \ge 0$

 	\begin{equation*}
		V^{w,h}(t) \ge -x
		\quad \ranget
		\quad \almostsurely
	\end{equation*}

	We write this as $h(\cdot) \in \mathcal(A)_{x}$, and we define 
	$\mathcal{A} \defeq \mathcal{A}_{0}$.

\end{defn}

\begin{defn} [Portfolio]
	\label{def:portfolio}

	A portfolio is a progressively measurable process $\pi(\cdot)$ uniformly bounded in 
	$(t,\omega)$,	where $\pi_{i}(t)$ represents the proportion of wealth invested in stock 
	$i$ at time $t$, with values is the set

	\begin{equation}
		\bigcup_{\kappa \in \mathbb{N}} 
		\left\{ 
			x \in \mathbb{R}^{n} \mid 
			\sum_{i=1}^{n} x_{i}^2 \le \kappa^2 \mid
			\sum_{i=1}^{n} x_{i} = 1
		\right\} 
 	\end{equation}
\end{defn}

\begin{defn} [Long-Only Portfolio]
	\label{def:longonlyportfolio}

	We say that a portfolio $\pi(\cdot)$ is \textit{long only} if 
	$\pi_{i}(t) \ge 0$ $\forall \rangei$. We also introduce the set 

	\begin{equation}
		\triangle_{+}^{n} \defeq 
		\left\{ x\in\mathbb{R}^{n}:x_{i}\ge0\;\forall \rangei \right\} 
 	\end{equation}

\end{defn}

Note that every portfolio generates a strategy by setting 

\begin{equation}
	\label{eq:wealthinvestedbyportfolio}
	h_i(t) = \pi_{i}(t)V^{w,\pi}(t),
	\quad \rangei
\end{equation}

\begin{defn} [Wealth Process]
	
	We denote \textit{the wealth process} of a portfolio $\pi(\cdot)$ with initial 
	wealth $w > 0$, by $V^{w,\pi}(\cdot)$.

\end{defn}

\begin{defn} [Self Financing Condition]
	
	A portfolio $\pi(\centerdot)$ is called \textit{self-financing} if 
	
	\begin{equation}
		V^{w,\pi}(T) = V^{w,\pi}(0) + \int_{0}^{T} \sum_{i=1}^{n} \pi_{i}(t) dX_{i}(t)
		\quad T \in [0, \infty)
 	\end{equation}

\end{defn}

TODO: This should be a lemma
\begin{rem} [Self Financing of Portfolio]
	Note that by definition portfolios are self-financing.
\end{rem}
 
\begin{thm} [Wealth Process of a Portfolio]

	The wealth-process $V^{w,\pi}(\centerdot)$ of a portfolio $\pi(\centerdot)$ and the initial 
	wealth $w$ corresponding to Definition \ref{def:portfolio} satisfies the stochastic differential 
	equation

	\begin{gather}
		\label{eq:wealthprocess}
		\begin{split}
			\frac{\d{V^{w,\pi}(t)}}{V^{w,\pi}(t)} 
				&= \sum_{i=1}^{n} \pi_{i}(t) \frac{\d{X_{i}(t)}}{X_{i}(t)} \\
				&= b_{\pi}(t)\d{t} + \sum_{\nu=1}^{d} \sigma_{\pi\nu}(t) \d{W_{\nu}(t)}
		\end{split}
	\end{gather}

	where we define the $b(\cdot)$, called the rate-of-return of portfolio $\pi(\cdot)$ as

	\begin{equation}
		\label{eq:bpi}
		b_{\pi}(t) \defeq \sum_{i=1}^{n} \pi_{i}(t) b_{i}(t)
	\end{equation}

	and the volatility coefficients $\sigma_{\pi\nu}(\cdot)$ as

	\begin{equation}
		\label{eq:sigmapi}
		\sigma_{\pi\nu}(\cdot) \defeq \sum_{i=1}^{n} \pi_{i}(t) \sigma_{i\nu}(t)
		\quad \nu=1,\dots,d
	\end{equation}

\end{thm}

\begin{proof}
	The proof (in a heuristic	fashion), suppose we denote the change in the portfolio
	value $V^{w,\pi}(t)$ caused by the change in the $i$th stock as $V_{i}^{w,\pi}(t)$,
	then

	\begin{equation*}
		\d{V_{i}^{w,\pi}(t)} = h_{i}(t) \frac{\d{X_{i}(t)}}{X_{i}(t)}
		\quad \rangei
	\end{equation*}

	then the total change in portfolio value across all stocks is

	\begin{gather*}
		\begin{split}
			\d{V^{w,\pi}(t)} 
					& = \sum_{i=1}^{n} h_{i}(t) \frac{\d{X_{i}(t)}}{X_{i}(t)} \\ 
					& = \sum_{i=1}^{n} \pi_{i}(t) V^{w,\pi}(t) \frac{\d{X_i(t)}}{X_i(t)} 
					\quad \text{From} (\ref{eq:wealthinvestedbyportfolio}) \\
					& = V^{w,\pi}(t) \sum_{i=1}^{n} \pi_{i}(t) \frac{\d{X_i(t)}}{X_i(t)} 
		\end{split}
	\end{gather*}

	which completes the proof for the first part of (\ref{eq:wealthprocess}). We
	prove the second equality by using (\ref{eq:stockpriceprocessdiff}), so that

	\begin{gather*}
		\begin{split}
			\frac{\d{V^{w,\pi}(t)}}{V^{w,\pi}(t)}
					& = \sum_{i=1}^{n} \pi_{i}(t) 
					\left(
						b_{i}(t)dt + \sum_{\nu=1}^{d} \sigma_{i\nu}(t) dW_{\nu}(t)
					\right) \\
					& = \sum_{i=1}^{n} \pi_{i}(t) b_{i}(t)dt + 
							\sum_{i=1}^{n} \sum_{\nu=1}^{d} \pi_{i}(t) \sigma_{i\nu}(t) dW_{\nu}(t) \\
					& = \sum_{i=1}^{n} \pi_{i}(t) b_{i}(t)dt + 
							\sum_{\nu=1}^{d} \sum_{i=1}^{n} \pi_{i}(t) \sigma_{i\nu}(t) dW_{\nu}(t) \\
					& = b_{\pi}(t)dt + 
							\sum_{\nu=1}^{d} \sum_{i=1}^{n} \pi_{i}(t) \sigma_{i\nu}(t) dW_{\nu}(t) 
					\quad (\ref{eq:bpi}) \\
					& = b_{\pi}(t)dt + 
							\sum_{\nu=1}^{d} \sum_{i=1}^{n} \sigma_{\pi\nu}(t) dW_{\nu}(t) 
					\quad (\ref{eq:sigmapi}) \\
		\end{split}
	\end{gather*}

\end{proof}

\begin{prop} [Strong Solution of Wealth Process]
	\label{prop:solutionofwealthprocess}

	Originally proved in \cite{fernholz1999}. 

	Let $\pi(\centerdot)$ be a portfolio, then the solution of (\ref{eq:wealthprocess}) is

	\begin{equation}
		\d{V^{w,\pi}(t)} =  
				\gamma_{\pi}(t) \d{t} +
				\sum_{\nu=1}^{d} \sigma_{\pi\nu}(t) \d{W_{\nu}(t)}
	\end{equation}

	or equivalently, as

	\begin{equation}
		V^{w,\pi}(t) = w \exp{ 
			\left(
				\int_{0}^{t} \gamma_{\pi}(u) \d{u} +
				\sum_{\nu=1}^{d} \int_{0}^{t} \sigma_{\pi\nu}(u) \d{W_{\nu}(u)}
			\right)},
	\quad \ranget
	\end{equation}

	where we define the process $\gamma_{\pi}(\cdot)$, called the \textit{growth rate} of the 
	portfolio $\pi(\cdot)$

	\begin{equation}
		\label{eq:portfoliogamma}
		\gamma_{\pi}(t) \defeq \sum_{i=1}^{n} \pi_{i}(t)\gamma_{i}(t) + \gamma_{\pi}^{*}(t)
	\end{equation}

	which in turn uses the definition of the process $\gamma_{\pi}^{*}(\cdot)$, called the
	\textit{excess growth rate}

	\begin{equation}
		\gamma_{\pi}^{*}(t) \defeq \frac{1}{2} 
				\left(
					\sum_{i=1}^{n} \pi_{i}(t)a_{ii}(t) -
					\sum_{i=1}^{n} \sum_{j=1}^{n} \pi_{i}(t)a_{ij}(t)\pi_{j}(t)
				\right)
	\end{equation}

\end{prop}

\begin{thm} [Growth Rate of Wealth Process]
	\label{thm:wealthgrowthrate}

	The justification for the quantity (\ref{eq:portoliogamma}) being called the 
	\textit{growth rate} is	because of the following relationship

	\begin{equation}
		\lim_{T \to \infty} 
			\left( 
			\log{V^{w,\pi}(T)} - \int_{0}^{T} \gamma_{\pi}(t)\d{t} 
			\right) = 0
		\quad \almostsurely
	\end{equation}

	TODO: Add the condition this is valid under.

\end{thm}

\begin{proof}
	See also Equation 1.14 of \cite{fernholz2009}.
	Build on Corollary 2.2 of \cite{fernholz1999}.

	TODO: Proof.
\end{proof}

\section{The Market Portfolio}

\begin{defn} [Market Portfolio]
	\label{def:marketportfolio}

	We define the process $\mu(\cdot)$ as a portfolio that invests the proportion
	$\mu_{i}(t)$ of current wealth in the $i$th asset at all times

	\begin{equation}
		\label{eq:marketportfolio}
		\mu_{i}(t) \defeq \frac{X_{i}(t)}{X(t)},
		\quad \rangei	
	\end{equation}

	where we define $X(t)$, as the total market capitalisation at time $t$ by

	\begin{equation}
		\label{eq:totalmarketcapitalisation}
		X(t) \defeq \sum_{i=1}^{n} X_{i}(t)	
	\end{equation}

  Due to the	assumption (ref???) that each stock has only one share outstanding the portfolio
	holds the same, constant number of shares at all times.

\end{defn}

\begin{thm} [Wealth Process of Market Portfolio]

	The wealth process of the Market Portfolio (Definition \ref{def:marketportfolio}) satisfies

	\begin{equation}
		\label{eq:wealthprocessofmarketportfolio}
			\frac{d{V^{w,\mu}(t)}}{V^{w,\mu}(t)} = \frac{d{X(t)}}{X(t)}  
	\end{equation}

\end{thm}

\begin{proof}

	From (\ref{eq:wealthprocess})

	\begin{gather}
		\begin{split}
			\frac{d{V^{w,\mu}(t)}}{V^{w,\mu}(t)} 
				& = \sum_{i=1}^{n} \mu_{i}(t) \frac{d{X_{i}(t)}}{X_{i}(t)} \\ 
				& = \sum_{i=1}^{n} \frac{X_{i}(t)}{X(t)} \frac{d{X_{i}(t)}}{X_{i}(t)} 
					\quad \text{using} (\ref{eq:marketportfolio}) \\ 
				& = \sum_{i=1}^{n} \frac{d{X_{i}(t)}}{X(t)} 
					\quad \text{using } (\ref{eq:totalmarketcapitalisation}) \\ 
				& = \frac{d{X(t)}}{X(t)}  
		\end{split}
	\end{gather}

\end{proof}

This means that investing in the portfolio $\mu(\cdot)$ is equivalent to ownership of
the entire market in proportion to the initial investment, so therefore

\begin{equation}
		V^{w,\mu}(t) = \frac{w}{X(0)}X(t)	
\end{equation}

From (Proposition \ref{prop:solutionofwealthprocess}) we can write, for the market portfolio
$\mu(\cdot)$

\begin{equation}
	\d{V^{w,\mu}(t)} =  
			\gamma_{\mu}(t) \d{t} +
			\sum_{\nu=1}^{d} \sigma_{\mu\nu}(t) \d{W_{\nu}(t)}
\end{equation}




\subsection{Arbitrage}

\begin{defn} [Arbitrage]
	\label{def:portfolio}
\end{defn}

\printbibliography


\end{document}
